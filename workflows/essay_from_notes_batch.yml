---
kind: workflow
id: essay_from_notes_batch
version: 0.1
summary: "Run essay_from_notes once for every file in content/essays/in/, archiving inputs under their outputs and clearing the input queue."
io:
  input_dir: content/essays/in/
  output_root: content/essays/out/
  child_workflow: essay_from_notes
constraints:
  - "Process only files matching *.md with YAML frontmatter."
  - "Archive each input under its corresponding output dir as input.md before deletion."
  - "Skip empty files; report and continue."
steps:
  - id: enumerate_inputs
    actor: s_vektor
    description: "List markdown files in input_dir; validate frontmatter presence."
    outputs: [inputs.list]
  - id: run_children
    actor: ivy
    description: "For each file in inputs.list, invoke child_workflow with --in <file>; wait for completion."
    outputs: [runs.log]
  - id: verify_and_sweep
    actor: s_vektor
    description: "For each processed input, confirm it was archived into content/essays/archive/YYYY-MM-DD/<slug>/input.md; then delete original from input_dir."
    outputs: [sweep.log]
postamble:
  notes:
    - "Provide a simple shell runner to implement the loop until the core runner supports child workflow invocation."
---
# Runner Guidance (batch)

Use the helper script:

```bash
scripts/run_essay_from_notes_batch.sh
```

This will iterate files in `content/essays/in/`, call the single-file workflow, verify archival, and remove inputs that were successfully archived.
